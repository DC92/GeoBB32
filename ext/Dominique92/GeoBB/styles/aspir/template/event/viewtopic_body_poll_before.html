<!-- Openlayers -->
<!-- INCLUDECSS assets/MyOl/ol/ol.css -->
<!-- INCLUDEJS assets/MyOl/ol/ol.js -->

<!-- Recherche par nom -->
<!-- INCLUDECSS assets/MyOl/geocoder/ol-geocoder.min.css -->
<!-- INCLUDEJS assets/MyOl/geocoder/ol-geocoder.js -->

<!-- My Openlayers -->
<!-- INCLUDECSS assets/MyOl/myol.css -->
<!-- INCLUDEJS assets/MyOl/myol.js -->

<!-- Style specific maps functions -->
<!-- INCLUDECSS map.css -->
<!-- INCLUDEJS map.js -->

<div id="map"></div>

<div>
	<p id="marqueur-json" class="geo-hidden">{GEOJSON}</p>
	<!-- IF GEO_MAP_TYPE == 'point' -->
		<p>Longitude <span id="marqueur-lon"></span>, Latitude <span id="marqueur-lat"></span></p>
		<p id="marqueur-xy">(CH1903) X <span id="marqueur-x"></span>, Y <span id="marqueur-y"></span></p>
	<!-- ENDIF -->

	<!-- IF FORUM_NAME == 'Alpages' -->
		<!-- IF GEO_EQUIPEMENT --><p>Autres équipements disponibles : {GEO_EQUIPEMENT}</p><!-- ENDIF -->
		<!-- IF GEO_TOPOGRAPHIE --><p>Topographie: {GEO_TOPOGRAPHIE}</p><!-- ENDIF -->
		<!-- IF GEO_SUPERFICIE --><p>Superficie : {GEO_SUPERFICIE}</p><!-- ENDIF -->
		<!-- IF GEO_VEGETATION --><p>Végétation : {GEO_VEGETATION}</p><!-- ENDIF -->
		<!-- IF GEO_IGN --><p>Carte IGN : {GEO_IGN}</p><!-- ENDIF -->
		<!-- IF GEO_OPERATEUR --><p>Opérateur téléphonique recommandé : {GEO_OPERATEUR}</p><!-- ENDIF -->
		<!-- IF GEO_COMMUNE --><p>Commune sur laquelle est située l'alpage : {GEO_COMMUNE}</p><!-- ENDIF -->
		<!-- IF GEO_ACCES --><p>Accès : {GEO_ACCES}</p><!-- ENDIF -->
		<!-- IF GEO_PARKING --><p>Où se garer : {GEO_PARKING}</p><!-- ENDIF -->
		<!-- IF GEO_PARCOURS --><p>Temps de parcours : {GEO_PARCOURS} minutes</p><!-- ENDIF -->
		<!-- IF GEO_MAE --><p>Présence de MAE : {GEO_MAE}</p><!-- ENDIF -->
		<!-- IF GEO_RESERVE --><p>Réserve de parc régional ou national : {GEO_RESERVE}</p><!-- ENDIF -->
		<!-- IF GEO_USAGERS --><p>Présence d'autres usagers : {GEO_USAGERS}</p><!-- ENDIF -->
		<p><!-- IF GEO_HELIPORTAGE_DATE -->Héliportage : {GEO_HELIPORTAGE_DATE}<!-- ENDIF -->
		<!-- IF GEO_HELIPORTAGE_POIDS -->poids : {GEO_HELIPORTAGE_POIDS} kg<!-- ENDIF --></p>
	<!-- ENDIF -->

	<!-- IF FORUM_NAME == 'Cabanes' -->
	<!-- ENDIF -->
</div>
<hr clear="all" style="border-color:transparent">

<script>
	window.addEventListener('load', function() {
		var map = new ol.Map({
				target: 'map',
				layers: [geoLayer({TOPIC_ID})],
				controls: geobbControls()
			});
		map.addControl(controlLayersSwitcher(
			layers({GEO_OLKEYS})
		));
		map.addControl(controlPermalink({
			init: false,
			visible: false
		}));

		<!-- IF GEO_MAP_TYPE == 'point' -->
			var marqueur = marker(markerImage, 'marqueur'),
				pos = marqueur.getPoint().getCoordinates();
			map.addLayer(marqueur);
			map.getView().setCenter(pos);
			map.getView().setZoom(15);
		<!-- ENDIF -->
		<!-- IF GEO_MAP_TYPE == 'surface' -->
			var eljson = document.getElementById('marqueur-json'),
				format = new ol.format.GeoJSON({
					featureProjection: "EPSG:3857"
				}),
				source = new ol.source.Vector({
					features: format.readFeatures(eljson.innerHTML)
				});
			map.getView().fit(source.getExtent());
		<!-- ENDIF -->
	});
</script>
